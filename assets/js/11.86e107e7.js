(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{585:function(t,s,a){t.exports=a.p+"assets/img/img.7c008d19.png"},596:function(t,s,a){"use strict";a.r(s);var n=a(17),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),n("p",[t._v("JS是一门单线程语言，这就意味着所有的任务都需要排队，前一个任务结束才会执行下一个任务。这样会出现一个问题： 如果JS执行时间过长，就可能会造成页面渲染不连贯，导致页面阻塞甚至卡死。为了解决这个问题，JS中出现了同步和\n异步。他们的本质区别是：一条流水线上的各个流程执行顺序不同。在执行顺序之前，先了解一下什么是同步任务与异步 任务。")]),t._v(" "),n("p",[t._v("同步任务：主线程上的任务，按照顺序从上到下依次执行，前一个任务完成才会执行下一个任务。")]),t._v(" "),n("p",[t._v("异步任务：不进入主线程，而是进入任务队列的任务，当主线程上的任务执行完成后，才会执行任务队列中的任务。")]),t._v(" "),n("h2",{attrs:{id:"宏任务-微任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#宏任务-微任务"}},[t._v("#")]),t._v(" 宏任务，微任务")]),t._v(" "),n("p",[t._v("宏任务，微任务属于js代码的范畴，js代码分为同步代码，异步代码，异步代码又分为宏任务和微任务。")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("任务")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("宏/微任务")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("环境")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("网络请求(Ajax)")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("宏任务")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("浏览器")])]),t._v(" "),n("tr",[n("td",[t._v("setTimeout()定时器")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("宏任务")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("浏览器")])]),t._v(" "),n("tr",[n("td",[t._v("fs.readFile()读取文件")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("宏任务")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("Node")])]),t._v(" "),n("tr",[n("td",[t._v("Promise.then()")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("微任务")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("浏览器/Node")])]),t._v(" "),n("tr",[n("td",[t._v("async/await")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("微任务")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("浏览器/Node")])])])]),t._v(" "),n("h2",{attrs:{id:"事件循环eventloop执行机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件循环eventloop执行机制"}},[t._v("#")]),t._v(" 事件循环EventLoop执行机制")]),t._v(" "),n("ol",[n("li",[t._v("进入到script标签，就进入到第一次事件循环")]),t._v(" "),n("li",[t._v("遇到同步代码，立即执行")]),t._v(" "),n("li",[t._v("遇到宏任务，放入到宏任务队列中")]),t._v(" "),n("li",[t._v("遇到微任务，放到微任务队列中")]),t._v(" "),n("li",[t._v("执行完成所有同步代码")]),t._v(" "),n("li",[t._v("执行"),n("strong",[t._v("微任务")])]),t._v(" "),n("li",[t._v("微任务执行完成，本次队列清空")]),t._v(" "),n("li",[t._v("寻找下一个宏任务，重复步骤1")])]),t._v(" "),n("p",[t._v("依次反复直到清空所有宏任务，这种不断重复的执行机制，就叫做事件循环\n"),n("img",{attrs:{src:a(585),alt:"img.png"}})]),t._v(" "),n("h2",{attrs:{id:"易错点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#易错点"}},[t._v("#")]),t._v(" 易错点")]),t._v(" "),n("ol",[n("li",[t._v("promise本身是同步的代码，只有在它后面调用的then()方法才是微任务")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   resolve\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("funciton")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 7 9 8")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("await中的代码才是微任务，右边的代码还是会立即执行")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("async1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("async2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("async2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("async1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1 3 2")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("script标签本身是宏任务，当页面中出现多个script标签时，浏览器会将script标签作为宏任务解析")])]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("scrpit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   console.log(1)\n   setTimeout(()=>{\n   console.log(2)\n   })\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("scrpit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("scrpit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   console.log(3)\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("scrpit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--1 3 2--\x3e")]),t._v("\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[t._v("setTimeout的误区")])]),t._v(" "),n("p",[t._v("宏任务setTimeout的回调不一定在指定的时间后能执行，而是在指定的时间后将回调函数放入事件循环的队列中。\n如果时间到了JS引擎还在执行同步任务，这个回调函数需要等待；如果当前事件循环的队列中还有其他回调，需要等\n其他回调执行完。另外setTimeout 0ms也不是立刻执行，他有一个默认的最小时间4ms。")])])}),[],!1,null,null,null);s.default=e.exports}}]);